<div class="relative flex flex-col min-w-0 break-words bg-white w-full mb-6 shadow-lg rounded transition-all duration-300 hover:shadow-xl">
  <div class="rounded-t mb-0 px-6 py-4 bg-gradient-to-r from-indigo-500 to-purple-600 text-white">
    <div class="flex flex-wrap items-center">
      <div class="relative w-full max-w-full flex-grow flex-1">
        <h6 class="uppercase mb-1 text-xs font-semibold text-indigo-100">
          Message Engagement
        </h6>
        <h2 class="text-xl font-bold flex items-center">
          <i class="fas fa-thumbs-up mr-2"></i> Most Liked Messages
        </h2>
      </div>
    </div>
  </div>
  <div class="p-6 flex-auto">
    <!-- Error message -->
    <div *ngIf="error" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4">
      <p>{{ error }}</p>
      <div class="mt-3 flex space-x-3">
        <button
          (click)="retryLoading()"
          class="bg-red-500 text-white active:bg-red-600 font-bold uppercase text-xs px-4 py-2 rounded shadow hover:shadow-md outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150"
        >
          Retry
        </button>
        <button
          (click)="testDirectEndpoint()"
          class="bg-blue-500 text-white active:bg-blue-600 font-bold uppercase text-xs px-4 py-2 rounded shadow hover:shadow-md outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150"
        >
          Test with Fetch API
        </button>
      </div>
    </div>

    <!-- Chart container with loading indicator -->
    <div class="relative w-full" style="height: 60vh; min-height: 400px;">
      <div id="chart-loading" class="absolute inset-0 flex items-center justify-center bg-white bg-opacity-80 z-10 hidden">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"></div>
      </div>
      <canvas id="likes-bar-chart"></canvas>
    </div>

    <!-- No data message -->
    <div *ngIf="stats.length === 0 && !loading && !error" class="text-center py-6 text-gray-500">
      <p>No user statistics available.</p>
      <button
        (click)="retryLoading()"
        class="mt-3 bg-red-500 text-white active:bg-red-600 font-bold uppercase text-xs px-4 py-2 rounded shadow hover:shadow-md outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150"
      >
        Retry
      </button>
    </div>

    <div *ngIf="stats.length > 0" class="text-center text-sm text-gray-500 mt-4">
      Showing most liked messages based on the number of likes received
    </div>
  </div>
</div>